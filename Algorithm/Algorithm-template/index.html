<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>算法模板 | 2inf</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><!-- modified--><link rel="stylesheet" type="text/css" href="/css/atom-one-dark.min.css?v=0.0.0"><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script><!----><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">算法模板</h1><a id="logo" href="/.">2inf</a><p class="description">wtyangのスペース(spread nonsense)</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/" target="_self"><i class="fa fa-archive"> 归档</i></a><a href="/tags/" target="_self"><i class="fa fa-tags"> 标签</i></a><a href="/about/" target="_self"><i class="fa fa-user"> 关于</i></a><a href="https://note.2inf.top" target="_self"><i class="fa fa-book"> 笔记</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><h1 class="post-title">算法模板</h1><div class="post-meta">2019-08-24<span> | </span><span class="category"><a href="/categories/Algorithm/">Algorithm</a></span></div><div class="post-content"><h1>基础</h1>
<h2 id="排序"><a class="header-anchor" href="#排序">¶</a>排序</h2>
<h3 id="归并排序"><a class="header-anchor" href="#归并排序">¶</a>归并排序</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">mergesort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span>(l == r) <span class="hljs-keyword">return</span> ;</span><br><span class="line">    <span class="hljs-keyword">int</span> mid = (l + r) &gt;&gt; <span class="hljs-number">1</span>;</span><br><span class="line">    mergesort(l, mid);</span><br><span class="line">    mergesort(mid + <span class="hljs-number">1</span>, r);</span><br><span class="line">    <span class="hljs-keyword">int</span> p = l, q = mid + <span class="hljs-number">1</span>, cnt = l;</span><br><span class="line">    <span class="hljs-keyword">while</span>(p &lt;= mid &amp;&amp; q &lt;= r)&#123;</span><br><span class="line">        <span class="hljs-keyword">if</span>(a[p] &lt; a[q]) t[cnt++] = a[p++];</span><br><span class="line">        <span class="hljs-keyword">else</span> t[cnt++] = a[q++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">while</span>(p &lt;= mid) t[cnt++] = a[p++];</span><br><span class="line">    <span class="hljs-keyword">while</span>(q &lt;= r) t[cnt++] = a[q++];</span><br><span class="line">    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = l; i &lt;= r; ++i) a[i] = t[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	vis[x] = <span class="hljs-number">-1</span>;</span><br><span class="line">	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y : G[x]) &#123;</span><br><span class="line">		<span class="hljs-keyword">if</span> (vis[y] == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// 存在环</span></span><br><span class="line">		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!vis[y] &amp;&amp; !dfs(y)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	vis[x] = <span class="hljs-number">1</span>;</span><br><span class="line">	a[++cnt] = x;</span><br><span class="line">	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="拓扑排序"><a class="header-anchor" href="#拓扑排序">¶</a>拓扑排序</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">int</span> head[N], nxt[N], ver[N], deg[N], tot, cnt;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    ver[++tot] = y;</span><br><span class="line">    nxt[tot] = head[x];</span><br><span class="line">    head[x] = tot;</span><br><span class="line">    deg[y]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">topsort</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="hljs-keyword">if</span> (!deg[i]) q.push(i);</span><br><span class="line">    <span class="hljs-keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        a[++cnt] = x;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = head[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> y = ver[i];</span><br><span class="line">            <span class="hljs-keyword">if</span> (--deg[y] == <span class="hljs-number">0</span>) q.push(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数学"><a class="header-anchor" href="#数学">¶</a>数学</h2>
<h3 id="素数"><a class="header-anchor" href="#素数">¶</a>素数</h3>
<ul>
<li>$Eratosthenes$筛法</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//O(nloglogn)</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sieve</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(v, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v));</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (v[i]) <span class="hljs-keyword">continue</span>;</span><br><span class="line">        p[++cnt] = i;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt; N / i; ++j) v[i*j] = <span class="hljs-number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>线性筛法</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//O(n)</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sieve</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(v, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v));</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (!v[i]) p[++cnt] = i;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= cnt &amp;&amp; p[j] * i &lt; N; ++j) &#123;</span><br><span class="line">            v[i*p[j]] = <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">if</span> (i % p[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="欧几里得"><a class="header-anchor" href="#欧几里得">¶</a>欧几里得</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> !b ? a : gcd(b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lcm</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> a / gcd(a, b) * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="扩展欧几里得"><a class="header-anchor" href="#扩展欧几里得">¶</a>扩展欧几里得</h3>
<p>  在求出$gcd(a,b)$的同时求出二元一次不定方程$ax+by=gcd(a,b)$的一组整数解</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (!b) x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">        exgcd(b, a % b, x, y);</span><br><span class="line">        y -= a / b * y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="乘法逆元"><a class="header-anchor" href="#乘法逆元">¶</a>乘法逆元</h3>
<p><a href="https://www.luogu.com.cn/problem/P3811" target="_blank" rel="noopener">模板题</a></p>
<ul>
<li>拓欧</li>
</ul>
<p>  若 $a\cdot x\equiv1{\pmod b}$，$a$ 与 $b$ 互质，则 $x$ 为 $a$ 的逆元，记为 $a^{-1}$，也称 $x$ 为 $a$ 在 $\mathrm{mod}\ b$ 下的倒数。</p>
<p>  利用拓欧求解 $a\cdot x\equiv1{\pmod b}$ 转化为求解 $a\cdot x+b\cdot y = 1$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">	<span class="hljs-keyword">if</span> (!b) x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;</span><br><span class="line">	<span class="hljs-keyword">else</span> exgcd(b, a % b, y, x), y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exgcd(i, p, x, y);</span><br><span class="line">x = (x % p + p) % p;</span><br></pre></td></tr></table></figure>
<ul>
<li>费马小定理</li>
</ul>
<p>  若 $p$ 为素数，$a$ 为正整数，且 $a$、$p$ 互质，则 $a^{p-1}\equiv1{\pmod p}$</p>
<p>  对于 $a\cdot x\equiv1\pmod p$，有 $a\cdot x\equiv a^{p-1}\pmod p$，即 $x\equiv a^{p-2}\pmod p$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function">ll <span class="hljs-title">qpow</span><span class="hljs-params">(ll a, ll b, ll MOD)</span> </span>&#123;</span><br><span class="line">	ll res = <span class="hljs-number">1</span>;</span><br><span class="line">	<span class="hljs-keyword">for</span> (; b; b &gt;&gt;= <span class="hljs-number">1</span>, (a *= a) %= MOD)</span><br><span class="line">		<span class="hljs-keyword">if</span> (b &amp; <span class="hljs-number">1</span>) (res *= a) %= MOD;</span><br><span class="line">	<span class="hljs-keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">write</span><span class="hljs-params">(ll x)</span> </span>&#123;</span><br><span class="line">	<span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">0</span>) <span class="hljs-built_in">putchar</span>(<span class="hljs-string">'-'</span>), x = -x;</span><br><span class="line">	<span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">9</span>) write(x / <span class="hljs-number">10</span>);</span><br><span class="line">	<span class="hljs-built_in">putchar</span>(x % <span class="hljs-number">10</span> ^ <span class="hljs-number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">write(qpow(i, p - <span class="hljs-number">2</span>, p)), <span class="hljs-built_in">puts</span>(<span class="hljs-string">""</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>线性方法</li>
</ul>
<p>  要求一串数字对 $\mathrm{mod}\ p$ 的逆元，设 $p=k\cdot i+r\quad(1\lt r\lt i\lt p)$，则</p>
<p>$$k\cdot i+r\equiv0\pmod p$$</p>
<p>乘 $i<sup>{-1},r</sup>{-1}$ 移项得</p>
<p>$$i^{-1}\equiv-k\cdot r^{-1}\pmod p$$</p>
<p>$$i<sup>{-1}\equiv-\lfloor\frac{p}{i}\rfloor\cdot(p \mathrm{mod} i)</sup>{-1} \pmod p$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inv[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i)</span><br><span class="line">	inv[i] = (p - p / i) * inv[p % i] % p;</span><br></pre></td></tr></table></figure>
<ul>
<li>阶乘逆元 $O(n)$</li>
</ul>
<p>若 $inv[i]=\frac{1}{(i+1)!}$，则 $inv[i+1]\times(i+1)=inv[i]$</p>
<p>$$\frac{1}{i!}\times(i-1)!\equiv\frac{1}{i}\pmod p$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (ll i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">	f[i] = (f[i<span class="hljs-number">-1</span>] * i) % p;</span><br><span class="line">inv[n] = qpow(f[n], p - <span class="hljs-number">2</span>, p);</span><br><span class="line"><span class="hljs-keyword">for</span> (ll i = n - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">1</span>; --i)</span><br><span class="line">	inv[i] = (inv[i+<span class="hljs-number">1</span>] * (i + <span class="hljs-number">1</span>)) % p;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i)</span><br><span class="line">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>, (inv[i] * f[i<span class="hljs-number">-1</span>]) % p);</span><br></pre></td></tr></table></figure>
<h3 id="欧拉函数"><a class="header-anchor" href="#欧拉函数">¶</a>欧拉函数</h3>
<p>  我们知道$\varphi(n)$表示小于$n$且与$n$互素的整数个数, 而$n$可分解为$n=\displaystyle\prod_{i=1}<sup>kp_i</sup>{a_i}$, 根据容斥原理我们有</p>
<p>$$\varphi(n)=\sum_{S\subseteq\left{p_1,p_2,\cdots,p_k\right}}(-1)^{|S|}\frac{n}{\displaystyle\prod_{p_i\in S}p_i}$$</p>
<p>  展开后可以得到</p>
<p>$$\varphi(n)=n*\prod_{i=1}^k\left(1-\frac{1}{p_i}\right)$$</p>
<ol>
<li>若$n$是素数 , 有$\varphi(n)=n−1$</li>
<li>若$gcd(n,m)=1$, 有$\varphi(mn)=\varphi(m)\varphi(n)$</li>
<li>若$n$和$m$是素数 , 有$\varphi(nm)=nm−1$</li>
<li>若$p$是素数 , 有$\varphi(p<sup>q)=p</sup>q−p^{q−1}$</li>
<li>$\displaystyle\sum_{d|m}\varphi(d)=m$</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">//单个Euler函数值</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">phi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;  </span><br><span class="line">	<span class="hljs-keyword">int</span> res = n;  </span><br><span class="line">	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i * i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="hljs-keyword">if</span> (n % i == <span class="hljs-number">0</span>) &#123; </span><br><span class="line">			res -= res / i; </span><br><span class="line">			<span class="hljs-keyword">while</span> (n % i == <span class="hljs-number">0</span>) n /= i; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) res -= res / n; </span><br><span class="line">	<span class="hljs-keyword">return</span> res;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-comment">//O(nlogn)</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">euler</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) phi[i] = i;</span><br><span class="line">	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i)</span><br><span class="line">		<span class="hljs-keyword">if</span> (phi[i] == i)</span><br><span class="line">			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt;= n; j += i)</span><br><span class="line">				phi[j] = phi[j] / i * (i - <span class="hljs-number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数据结构"><a class="header-anchor" href="#数据结构">¶</a>数据结构</h2>
<h3 id="并查集"><a class="header-anchor" href="#并查集">¶</a>并查集</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (fa[x] == x) <span class="hljs-keyword">return</span> x;</span><br><span class="line">    <span class="hljs-keyword">int</span> root = find(fa[x]);</span><br><span class="line">    d[x] += d[fa[x]];</span><br><span class="line">    <span class="hljs-keyword">return</span> fa[x] = root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unite</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">int</span> fx = find(x);</span><br><span class="line">    <span class="hljs-keyword">int</span> fy = find(y);</span><br><span class="line">    <span class="hljs-keyword">if</span> (fx == fy) <span class="hljs-keyword">return</span>;</span><br><span class="line">    fa[fx] = fy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="图论"><a class="header-anchor" href="#图论">¶</a>图论</h2>
<h3 id="最短路"><a class="header-anchor" href="#最短路">¶</a>最短路</h3>
<h4 id="dijkstra"><a class="header-anchor" href="#dijkstra">¶</a>$dijkstra$</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">int</span> n, m, s;</span><br><span class="line"><span class="hljs-keyword">int</span> a[N][N], d[N], pre[N], vis[N];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        d[i] = INF; vis[i] = <span class="hljs-number">0</span>; pre[i] = <span class="hljs-number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    d[s] = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = <span class="hljs-number">-1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="hljs-keyword">if</span> (!vis[j] &amp;&amp; (x == <span class="hljs-number">-1</span> || d[j] &lt; d[x])) x = j;</span><br><span class="line">        vis[x] = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">1</span>; y &lt;= n; ++y)</span><br><span class="line">            <span class="hljs-keyword">if</span> (d[y] &gt; d[x] + a[x][y]) &#123;</span><br><span class="line">                d[y] = d[x] + a[x][y];</span><br><span class="line">                pre[y] = x;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="dijkstra-堆优化"><a class="header-anchor" href="#dijkstra-堆优化">¶</a>$dijkstra(堆优化)$</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span></span></span><br><span class="line"><span class="hljs-class">&#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> next, to, w;</span><br><span class="line">&#125;e[M];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span></span></span><br><span class="line"><span class="hljs-function"></span>&#123;</span><br><span class="line">    e[++tot].w = z;</span><br><span class="line">    e[tot].next = head[x];</span><br><span class="line">    e[tot].to = y;</span><br><span class="line">    head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>&#123;</span><br><span class="line">    d[s] = <span class="hljs-number">0</span>;</span><br><span class="line">    q.push(make_pair(<span class="hljs-number">0</span>, s));</span><br><span class="line">    <span class="hljs-keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = q.top().second;</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="hljs-keyword">if</span> (vis[x]) <span class="hljs-keyword">continue</span>;</span><br><span class="line">        vis[x] = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = head[x]; i; i = e[i].next) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> y = e[i].to;</span><br><span class="line">            <span class="hljs-keyword">if</span> (d[y] &gt; d[x] + e[i].w) &#123;</span><br><span class="line">                d[y] = d[x] + e[i].w;</span><br><span class="line">                q.push(make_pair(-d[y], y));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="spfa"><a class="header-anchor" href="#spfa">¶</a>$spfa$</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    ver[++tot] = y, edge[tot] = z, nxt[tot] = head[x], head[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">spfa</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(d));</span><br><span class="line">    <span class="hljs-built_in">memset</span>(v, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v));</span><br><span class="line">    d[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>; v[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    q.push(<span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">        v[x] = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = head[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> y = ver[i];</span><br><span class="line">            <span class="hljs-keyword">if</span> (d[y] &gt; d[x] + edge[i]) &#123;</span><br><span class="line">                d[y] = d[x] + edge[i];</span><br><span class="line">                <span class="hljs-keyword">if</span> (!v[y]) q.push(y), v[y] = <span class="hljs-number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="最小生成树"><a class="header-anchor" href="#最小生成树">¶</a>最小生成树</h3>
<h4 id="kruskal-算法"><a class="header-anchor" href="#kruskal-算法">¶</a>$Kruskal$算法</h4>
<p>  比较适合于稀疏图</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">5005</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> M = <span class="hljs-number">2e5</span> + <span class="hljs-number">5</span>;</span><br><span class="line"><span class="hljs-keyword">int</span> n, m, f[N];</span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">edge</span></span></span><br><span class="line"><span class="hljs-class">&#123;</span></span><br><span class="line">    <span class="hljs-keyword">int</span> u, v, w;</span><br><span class="line">    <span class="hljs-keyword">friend</span> <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &lt; (edge a, edge b) &#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> a.w &lt; b.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;e[M];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span> (f[x] == x) <span class="hljs-keyword">return</span> x;</span><br><span class="line">    <span class="hljs-keyword">return</span> f[x] = find(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">krusal</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    sort(e + <span class="hljs-number">1</span>, e + m + <span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>, ans = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) f[i] = i;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = find(e[i].u);</span><br><span class="line">        <span class="hljs-keyword">int</span> y = find(e[i].v);</span><br><span class="line">        <span class="hljs-keyword">if</span> (x != y) &#123;</span><br><span class="line">            ans += e[i].w;</span><br><span class="line">            f[x] = y;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-keyword">if</span> (cnt == n - <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">if</span> (cnt &lt; n - <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; <span class="hljs-comment">//不连通</span></span><br><span class="line">    <span class="hljs-keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="prim-算法"><a class="header-anchor" href="#prim-算法">¶</a>$Prim$算法</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">5005</span>;</span><br><span class="line"><span class="hljs-keyword">int</span> n, m, ans;</span><br><span class="line"><span class="hljs-keyword">int</span> a[N][N], d[N], v[N];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">prim</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span>(d));</span><br><span class="line">    d[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            <span class="hljs-keyword">if</span> (!v[j] &amp;&amp; (x == <span class="hljs-number">0</span> || d[j] &lt; d[x])) x = j;</span><br><span class="line">        v[x] = <span class="hljs-number">1</span>;</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> y = <span class="hljs-number">1</span>; y &lt;= n; ++y)</span><br><span class="line">            <span class="hljs-keyword">if</span> (!v[y]) d[y] = min(d[y], a[x][y]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1>提高</h1>
<h2 id="图论-v2"><a class="header-anchor" href="#图论-v2">¶</a>图论</h2>
<h3 id="网络流初步"><a class="header-anchor" href="#网络流初步">¶</a>网络流初步</h3>
<h4 id="edmonds-karp"><a class="header-anchor" href="#edmonds-karp">¶</a>Edmonds-Karp</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">int</span> n, m, s, t, maxflow, tot = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">int</span> ver[M], edge[M], Next[M], head[N], v[N], incf[N], pre[N];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    ver[++tot] = y, edge[tot] = z, Next[tot] = head[x], head[x] = tot;</span><br><span class="line">    ver[++tot] = x, edge[tot] = <span class="hljs-number">0</span>, Next[tot] = head[y], head[y] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">memset</span>(v, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v));</span><br><span class="line">    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt; q;</span><br><span class="line">    q.push(s); v[s] = <span class="hljs-number">1</span>;</span><br><span class="line">    incf[s] = INF;</span><br><span class="line">    <span class="hljs-keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = head[x]; i; i = Next[i])</span><br><span class="line">            <span class="hljs-keyword">if</span> (edge[i]) &#123;</span><br><span class="line">                <span class="hljs-keyword">int</span> y = ver[i];</span><br><span class="line">                <span class="hljs-keyword">if</span> (v[y]) <span class="hljs-keyword">continue</span>;</span><br><span class="line">                incf[y] = min(incf[x], edge[i]);</span><br><span class="line">                pre[y] = i;</span><br><span class="line">                q.push(y);</span><br><span class="line">                v[y] = <span class="hljs-number">1</span>;</span><br><span class="line">                <span class="hljs-keyword">if</span> (y == t) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">EK</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">while</span> (bfs()) &#123;</span><br><span class="line">        <span class="hljs-keyword">int</span> x = t;</span><br><span class="line">        <span class="hljs-keyword">while</span> (x != s) &#123;</span><br><span class="line">            <span class="hljs-keyword">int</span> i = pre[x];</span><br><span class="line">            edge[i] -= incf[t];</span><br><span class="line">            edge[i^<span class="hljs-number">1</span>] += incf[t];</span><br><span class="line">            x = ver[i^<span class="hljs-number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        maxflow += incf[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="dinic"><a class="header-anchor" href="#dinic">¶</a>Dinic</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>附录</h1>
<h2 id="对拍"><a class="header-anchor" href="#对拍">¶</a>对拍</h2>
<p>$bat$语言版本</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@<span class="hljs-built_in">echo</span> off</span><br><span class="line"><span class="hljs-built_in">set</span> cnt=<span class="hljs-number">0</span></span><br><span class="line"><span class="hljs-keyword">for</span> /l <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>) <span class="hljs-keyword">do</span> (</span><br><span class="line">  mine.exe &lt; stdin<span class="hljs-variable">%%i</span>.txt &gt; out<span class="hljs-variable">%%i</span>.txt</span><br><span class="line">  fc out<span class="hljs-variable">%%i</span>.txt stdout<span class="hljs-variable">%%i</span>.txt &gt; diff<span class="hljs-variable">%%i</span>.txt</span><br><span class="line">  <span class="hljs-keyword">if</span> <span class="hljs-keyword">errorlevel</span> <span class="hljs-number">1</span> (</span><br><span class="line">    <span class="hljs-built_in">set</span> cnt=<span class="hljs-number">1</span></span><br><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-variable">%%i</span>:UnAccepted!</span><br><span class="line">  )</span><br><span class="line">  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">errorlevel</span> <span class="hljs-number">1</span> (</span><br><span class="line">    <span class="hljs-built_in">del</span> diff<span class="hljs-variable">%%i</span>.txt</span><br><span class="line">    <span class="hljs-built_in">echo</span> <span class="hljs-variable">%%i</span>:Accepted!</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line"><span class="hljs-keyword">if</span> <span class="hljs-variable">%cnt%</span>==<span class="hljs-number">0</span> <span class="hljs-built_in">color</span> a &amp;&amp; <span class="hljs-built_in">echo</span> *** Totally Accepted! ***</span><br><span class="line"><span class="hljs-keyword">if</span> <span class="hljs-variable">%cnt%</span>==<span class="hljs-number">1</span> <span class="hljs-built_in">color</span> c &amp;&amp; <span class="hljs-built_in">echo</span> *** <span class="hljs-keyword">Not</span> All Accepted! ***</span><br><span class="line"><span class="hljs-built_in">pause</span></span><br></pre></td></tr></table></figure>
<h2 id="vim配置"><a class="header-anchor" href="#vim配置">¶</a>vim配置</h2>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">syntax</span> enable</span><br><span class="line"><span class="hljs-keyword">syntax</span> <span class="hljs-keyword">on</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">set</span> <span class="hljs-keyword">nu</span></span><br><span class="line"><span class="hljs-keyword">set</span> ruler</span><br><span class="line"><span class="hljs-keyword">set</span> cul</span><br><span class="line"><span class="hljs-keyword">set</span> tabstop=<span class="hljs-number">4</span></span><br><span class="line"><span class="hljs-keyword">set</span> <span class="hljs-built_in">shiftwidth</span>=<span class="hljs-number">4</span></span><br><span class="line"><span class="hljs-keyword">set</span> expandtab</span><br><span class="line"><span class="hljs-keyword">set</span> autoindent</span><br><span class="line"><span class="hljs-keyword">set</span> nobackup</span><br><span class="line"><span class="hljs-keyword">set</span> paste</span><br><span class="line"><span class="hljs-keyword">set</span> incsearch</span><br><span class="line"><span class="hljs-keyword">set</span> showcmd</span><br><span class="line"><span class="hljs-keyword">set</span> showmatch</span><br><span class="line"><span class="hljs-keyword">set</span> ignorecase</span><br><span class="line"><span class="hljs-keyword">set</span> cin</span><br><span class="line"><span class="hljs-keyword">colo</span> evening</span><br><span class="line"><span class="hljs-keyword">set</span> mouse=<span class="hljs-keyword">a</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">nnoremap</span> <span class="hljs-symbol">&lt;F9&gt;</span> :<span class="hljs-keyword">call</span> CompileRun()<span class="hljs-symbol">&lt;CR&gt;</span></span><br><span class="line">func! CompileRun()</span><br><span class="line">    exec <span class="hljs-string">"w"</span></span><br><span class="line">    <span class="hljs-keyword">if</span> &amp;<span class="hljs-keyword">filetype</span> <span class="hljs-keyword">is</span> <span class="hljs-string">'cpp'</span> || &amp;<span class="hljs-keyword">filetype</span> <span class="hljs-keyword">is</span> <span class="hljs-string">'c'</span> || &amp;<span class="hljs-keyword">filetype</span> <span class="hljs-keyword">is</span> <span class="hljs-string">'cc'</span></span><br><span class="line">        exec <span class="hljs-string">"!g++ -Wall % -0 %&lt;"</span></span><br><span class="line">        exec <span class="hljs-string">"!time ./%&lt;"</span></span><br><span class="line">    <span class="hljs-keyword">elseif</span> &amp;<span class="hljs-keyword">filetype</span> <span class="hljs-keyword">is</span> <span class="hljs-string">'java'</span></span><br><span class="line">        exec <span class="hljs-string">"!javac\ -d\ .\ %"</span></span><br><span class="line">        exec <span class="hljs-string">"!javac\ %&lt;"</span></span><br><span class="line">    <span class="hljs-keyword">endif</span></span><br><span class="line">endfunc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">call</span> plug#begin(<span class="hljs-string">'~/.vim/plugged'</span>)</span><br><span class="line"></span><br><span class="line">Plug <span class="hljs-string">'itchyny/lightline.vim'</span></span><br><span class="line">Plug <span class="hljs-string">'SirVer/ultisnips'</span></span><br><span class="line">Plug <span class="hljs-string">'honza/vim-snippets'</span></span><br><span class="line">Plug <span class="hljs-string">'preservim/nerdtree'</span>                      <span class="hljs-comment">" 目录树</span></span><br><span class="line">Plug <span class="hljs-string">'tiagofumo/vim-nerdtree-syntax-highlight'</span> <span class="hljs-comment">" 目录树美化</span></span><br><span class="line">Plug <span class="hljs-string">'vim-airline/vim-airline'</span>                 <span class="hljs-comment">" 状态栏美化</span></span><br><span class="line">Plug <span class="hljs-string">'vim-airline/vim-airline-themes'</span>          <span class="hljs-comment">" 状态栏美化主题</span></span><br><span class="line">Plug <span class="hljs-string">'scrooloose/syntastic'</span>                    <span class="hljs-comment">" 语法错误提示</span></span><br><span class="line">Plug <span class="hljs-string">'suan/vim-instant-markdown'</span>               <span class="hljs-comment">" markdown 实时预览</span></span><br><span class="line">Plug <span class="hljs-string">'ryanoasis/vim-devicons'</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">call</span> plug#end()</span><br></pre></td></tr></table></figure></div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><!--pspan= __('copyright_title_prefix')
= page.title--><p><span>文章作者：</span>wtyang</p><!--pspan= __('copyright_date_prefix')
= page.date.format(config.date_format)--><!--pspan= __('copyright_update_prefix')
= page.updated.format(config.date_format)--><p><span>原始链接：</span><a href="/Algorithm/Algorithm-template/">https://2inf.top/Algorithm/Algorithm-template/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://2inf.top/Algorithm/Algorithm-template/"></i></span></p><p><span>版权声明：</span>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a> 许可协议。转载请注明出处！</p></div><br><div class="tags"></div><div class="post-nav"><a class="pre" href="/Algorithm/Theory-of-Inversion/">反演原理及应用</a><a class="next" href="/Algorithm/POJ1845-Sumdiv/">POJ1845 Sumdiv</a></div></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer">Copyright © 2022 <a href="/." rel="nofollow">2inf</a>&nbsp;|&nbsp;<a href="http://www.beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">湘ICP备20012049号-1 </a>|&nbsp;
<a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i>&nbsp;RSS Feed</a><div><link rel="stylesheet" type="text/css" href="/css/badge.css"/><div class="github-badge"><a rel="nofollow" target="_blank" href="https://hexo.io"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hexo</span></a></div>
<div class="github-badge"> <a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"><span class="badge-subject">Theme</span><span class="badge-value bg-orange">maupassant</span></a></div>
<div class="github-badge"> <a rel="nofollow" target="_blank" href="https://www.cnblogs.com/2inf/"><span class="badge-subject">cnblogs</span><span class="badge-value bg-blueviolet">2inf</span></a></div></div></div></div></div><div class="post-toc"><div class="post-toc-wrap"><div class="post-toc" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#排序"><span class="toc-number">1.1.</span> <span class="toc-text">¶排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#归并排序"><span class="toc-number">1.1.1.</span> <span class="toc-text">¶归并排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拓扑排序"><span class="toc-number">1.1.2.</span> <span class="toc-text">¶拓扑排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数学"><span class="toc-number">1.2.</span> <span class="toc-text">¶数学</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#素数"><span class="toc-number">1.2.1.</span> <span class="toc-text">¶素数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#欧几里得"><span class="toc-number">1.2.2.</span> <span class="toc-text">¶欧几里得</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#扩展欧几里得"><span class="toc-number">1.2.3.</span> <span class="toc-text">¶扩展欧几里得</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#乘法逆元"><span class="toc-number">1.2.4.</span> <span class="toc-text">¶乘法逆元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#欧拉函数"><span class="toc-number">1.2.5.</span> <span class="toc-text">¶欧拉函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据结构"><span class="toc-number">1.3.</span> <span class="toc-text">¶数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#并查集"><span class="toc-number">1.3.1.</span> <span class="toc-text">¶并查集</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图论"><span class="toc-number">1.4.</span> <span class="toc-text">¶图论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#最短路"><span class="toc-number">1.4.1.</span> <span class="toc-text">¶最短路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dijkstra"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">¶$dijkstra$</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dijkstra-堆优化"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">¶$dijkstra(堆优化)$</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#spfa"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">¶$spfa$</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最小生成树"><span class="toc-number">1.4.2.</span> <span class="toc-text">¶最小生成树</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#kruskal-算法"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">¶$Kruskal$算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#prim-算法"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">¶$Prim$算法</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">提高</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#图论-v2"><span class="toc-number">2.1.</span> <span class="toc-text">¶图论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#网络流初步"><span class="toc-number">2.1.1.</span> <span class="toc-text">¶网络流初步</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#edmonds-karp"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">¶Edmonds-Karp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dinic"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">¶Dinic</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">附录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#对拍"><span class="toc-number">3.1.</span> <span class="toc-text">¶对拍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vim配置"><span class="toc-number">3.2.</span> <span class="toc-text">¶vim配置</span></a></li></ol></li></ol></div></div><div class="post-toc-toggle-wrap open" id="right-toggle"><div class="post-toc-toggle-first post-toc-toggle"></div><div class="post-toc-toggle-second post-toc-toggle"></div><div class="post-toc-toggle-thrid post-toc-toggle"></div></div><script type="text/javascript" src="/js/sidebar.js?v=0.0.0" async></script></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processClass: 'math', processEscapes: true },
  TeX: {equationNumbers: { autoNumber: ['AMS'], useLabelIds: true }},
  'HTML-CSS': { linebreaks: { automatic: true } },
  SVG: { linebreaks: { automatic: true } }
  });
</script><!--script(type='text/javascript', src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', async)--><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script><script>hljs.initHighlightingOnLoad();</script><script type="text/javascript" src="/js/app.js?v=0.0.0"></script></div></body></html>